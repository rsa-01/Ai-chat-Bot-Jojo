"use strict";var l=Object.defineProperty;var T=Object.getOwnPropertyDescriptor;var w=Object.getOwnPropertyNames;var x=Object.prototype.hasOwnProperty;var U=(t,e)=>{for(var s in e)l(t,s,{get:e[s],enumerable:!0})},R=(t,e,s,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of w(e))!x.call(t,i)&&i!==s&&l(t,i,{get:()=>e[i],enumerable:!(r=T(e,i))||r.enumerable});return t};var A=t=>R(l({},"__esModule",{value:!0}),t);var D={};U(D,{InvalidParameterError:()=>p,InvalidURIError:()=>a,MissingParameterError:()=>g,URIParseError:()=>u,generate:()=>m,generateHOTP:()=>O,generateTOTP:()=>I,parse:()=>d,parseURI:()=>d});module.exports=A(D);var u=class extends Error{constructor(e){super(e),this.name="URIParseError"}},a=class extends u{constructor(e){super(`Invalid otpauth URI: ${e}`),this.name="InvalidURIError"}},g=class extends u{constructor(e){super(`Missing required parameter: ${e}`),this.name="MissingParameterError"}},p=class extends u{constructor(e,s){super(`Invalid value for parameter '${e}': ${s}`),this.name="InvalidParameterError"}};var P=2048,b=512,$=1024;function E(t,e){let s=t instanceof Error?t.message:String(t);return`Invalid URI encoding in ${e}: ${s}`}function h(t,e,s){if(t.length>e*3)throw new a(`${s} exceeds maximum length`);try{let r=decodeURIComponent(t);if(r.length>e)throw new a(`${s} exceeds maximum length of ${e} characters`);return r}catch(r){throw r instanceof a?r:new a(E(r,s))}}function d(t){if(t.length>P)throw new a(`URI exceeds maximum length of ${P} characters`);if(!t.startsWith("otpauth://"))throw new a(t);let e=t.slice(10),s=e.indexOf("/");if(s===-1)throw new a(t);let r=e.slice(0,s);if(r!=="hotp"&&r!=="totp")throw new p("type",r);let i=e.slice(s+1),o=i.indexOf("?"),n,c;o===-1?(n=h(i,b,"label"),c=""):(n=h(i.slice(0,o),b,"label"),c=i.slice(o+1));let f=H(c);if(!f.secret)throw new g("secret");return{type:r,label:n,params:f}}function H(t){let e={};if(!t)return e;let s=t.split("&");for(let r of s){let i=r.indexOf("=");if(i===-1)continue;let o=h(r.slice(0,i),64,"parameter key"),n=h(r.slice(i+1),$,`parameter '${o}'`);switch(o){case"secret":e.secret=n;break;case"issuer":e.issuer=n;break;case"algorithm":e.algorithm=M(n);break;case"digits":e.digits=k(n);break;case"counter":e.counter=y("counter",n,0);break;case"period":e.period=y("period",n,1);break}}return e}function y(t,e,s){if(!/^-?\d+$/.test(e))throw new p(t,e);let r=Number(e);if(!Number.isSafeInteger(r))throw new p(t,e);if(r<s)throw new p(t,e);return r}function M(t){let e=t.toLowerCase();if(e==="sha1"||e==="sha-1")return"sha1";if(e==="sha256"||e==="sha-256")return"sha256";if(e==="sha512"||e==="sha-512")return"sha512";throw new p("algorithm",t)}function k(t){if(!/^\d+$/.test(t))throw new p("digits",t);let e=Number(t);if(e===6||e===7||e===8)return e;throw new p("digits",t)}function m(t){let{type:e,label:s,params:r}=t,i=s.split(":").map(c=>encodeURIComponent(c)).join(":"),o=`otpauth://${e}/${i}?`,n=[];return r.secret&&n.push(`secret=${encodeURIComponent(r.secret)}`),r.issuer&&n.push(`issuer=${encodeURIComponent(r.issuer)}`),r.algorithm&&r.algorithm!=="sha1"&&n.push(`algorithm=${r.algorithm.toUpperCase()}`),r.digits&&r.digits!==6&&n.push(`digits=${r.digits}`),e==="hotp"&&r.counter!==void 0&&n.push(`counter=${r.counter}`),e==="totp"&&r.period!==void 0&&r.period!==30&&n.push(`period=${r.period}`),o+=n.join("&"),o}function I(t){let{issuer:e,label:s,secret:r,algorithm:i="sha1",digits:o=6,period:n=30}=t,c=e?`${e}:${s}`:s;return m({type:"totp",label:c,params:{secret:r,issuer:e,algorithm:i,digits:o,period:n}})}function O(t){let{issuer:e,label:s,secret:r,counter:i=0,algorithm:o="sha1",digits:n=6}=t,c=e?`${e}:${s}`:s;return m({type:"hotp",label:c,params:{secret:r,issuer:e,algorithm:o,digits:n,counter:i}})}0&&(module.exports={InvalidParameterError,InvalidURIError,MissingParameterError,URIParseError,generate,generateHOTP,generateTOTP,parse,parseURI});
//# sourceMappingURL=index.cjs.map